---
title: 데이터베이스 복제
titleSuffix: Configuration Manager
description: Configuration Manager 데이터베이스 복제에서 SQL Server를 사용하여 계층의 데이터를 전송하는 방법을 알아봅니다.
ms.date: 08/09/2019
ms.prod: configuration-manager
ms.technology: configmgr-other
ms.topic: conceptual
ms.assetid: 8b495b02-c966-4eb3-92b9-52ebbf5c38ae
author: mestew
ms.author: mstewart
manager: dougeby
ms.collection: M365-identity-device-management
ms.openlocfilehash: 0ec1145357b68002d6966c437cf4943de6d5cebb
ms.sourcegitcommit: 1bccb61bf3c7c69d51e0e224d0619c8f608e8777
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 12/05/2019
ms.locfileid: "68957903"
---
# <a name="database-replication"></a>데이터베이스 복제

*적용 대상: System Center Configuration Manager(현재 분기)*

Configuration Manager 데이터베이스 복제에서 SQL Server를 사용하여 데이터를 전송합니다. 이 방법을 사용하여 사이트 데이터베이스의 변경 내용을 계층의 다른 사이트에 있는 데이터베이스의 정보와 병합합니다.

데이터베이스 복제에 대한 다음 사항에 유의하세요.

- 모든 사이트는 동일한 정보를 공유합니다.  

- 계층 구조에 사이트를 설치하면 Configuration Manager에서는 새로운 사이트와 그 상위 사이트 간의 데이터베이스 복제가 자동으로 설정됩니다.  

- 사이트 설치가 완료되면 데이터베이스 복제는 자동으로 시작됩니다.  

계층 구조에 새 사이트를 추가하면 Configuration Manager에서 새 사이트에 일반 데이터베이스를 만듭니다. 부모 사이트는 해당 데이터베이스에 관련 데이터의 스냅샷을 만듭니다. 그런 다음, [파일 기반 복제](/sccm/core/plan-design/hierarchy/file-based-replication)를 사용하여 스냅샷을 새 사이트로 전송합니다. 새 사이트에서는 SQL Server BCP(대량 복사 프로그램)를 사용하여 Configuration Manager 데이터베이스의 자체 로컬 복사본에 정보를 로드합니다. 스냅샷이 로드되면 각 사이트는 다른 사이트와 함께 데이터베이스 복제를 수행합니다.  

Configuration Manager는 자체의 데이터베이스 복제 서비스를 사용하여 사이트 간에 데이터를 복제합니다. 데이터베이스 복제 서비스에서는 SQL Server 변경 내용 추적으로 로컬 사이트 데이터베이스의 변경 사항이 모니터링됩니다. 그런 다음 해당 변경 사항은 SSB(SQL Server Service Broker)를 통하여 다른 사이트로 복제됩니다. 기본적으로 이 프로세스에는 TCP 포트 4022가 사용됩니다.  


## <a name="replication-groups"></a>복제 그룹

Configuration Manager에서는 데이터베이스 복제에 따라 복제되는 데이터를 여러 복제 그룹으로 그룹화합니다. 각 복제 그룹에는 별도로 확정된 복제 일정이 있습니다. 사이트에서는 이 일정을 사용하여 다른 사이트로의 변경 사항 복제 빈도를 결정합니다.  

예를 들어 역할 기반 관리 구성의 변경 사항은 다른 사이트로 신속히 복제될 수 있습니다. 이 동작에 따라 다른 사이트에서는 해당 변경 사항을 빠르게 적용할 수 있습니다. 새 보조 사이트 설치 요청처럼 우선 순위가 낮은 구성 변경 사항은 덜 긴급한 사항으로서 복제됩니다. 새 사이트 요청이 대상 기본 사이트에 도달하는 데 몇 분 정도 걸릴 수 있습니다.  


## <a name="settings"></a>설정

데이터베이스 복제에 대한 다음 설정을 수정할 수 있습니다.  

- **데이터베이스 복제 링크**: 특정 트래픽이 네트워크를 트래버스하는 시점을 제어합니다.  

- **분산 보기**: CAS(중앙 관리 사이트)에서 선택된 사이트 데이터를 요청하는 경우, 해당 사이트에서는 하위 기본 사이트의 데이터베이스에서 데이터에 곧바로 액세스할 수 있습니다.  

- **일정**: 복제 링크 사용 시점과 각 유형의 사이트 데이터 복제 시점을 지정합니다.  

- **요약**: 복제 링크를 트래버스하는 네트워크 트래픽에 대한 데이터 요약 설정을 변경합니다. 기본적으로 요약은 15 분마다 발생합니다. 이는 데이터베이스 복제용 보고서에 사용됩니다.  

- **데이터베이스 복제 임계값**: 사이트에서 링크가 저하되었거나 실패했다고 보고하는 시점을 정의합니다. 또한 저하됨 또는 실패 상태의 복제 링크에 대해 Configuration Manager에서 경고를 생성하는 시점을 구성할 수도 있습니다.  


## <a name="types-of-data"></a>데이터 형식

Configuration Manager에서는 여기서 복제하는 데이터를 주로 *글로벌 데이터*나 *사이트 데이터*로 분류합니다. 데이터베이스 복제가 실행되면 사이트는 데이터베이스 복제 링크를 통해 글로벌 데이터와 사이트 데이터의 변경 사항을 전송합니다. 글로벌 데이터는 상위 또는 하위 사이트에 복제됩니다. 사이트 데이터는 부모 사이트에만 복제됩니다. 세 번째 데이터 형식인 *로컬 데이터*는 다른 사이트에 복제되지 않습니다. 로컬 데이터에는 다른 사이트에 필요하지 않은 정보가 포함됩니다.  

### <a name="global-data"></a>글로벌 데이터

글로벌 데이터는 관리자가 만드는 개체로서 계층 전체의 모든 사이트에 복제됩니다. 보조 사이트는 글로벌 데이터의 하위 집합을 글로벌 프록시 데이터로서 수신합니다. 글로벌 데이터는 CAS와 기본 사이트에서 만듭니다. 이 유형에는 다음의 데이터가 포함됩니다.

- 소프트웨어 배포
- 소프트웨어 업데이트
- 컬렉션 정의
- 역할 기반 관리 보안 범위

### <a name="site-data"></a>사이트 데이터

사이트 데이터는 Configuration Manager 기본 사이트와 여기에서 할당한 클라이언트가 만드는 운영 정보입니다. 사이트 데이터는 CAS에 복제되지만 다른 기본 사이트에는 복제되지 않습니다. 사이트 데이터는 CAS와 데이터가 처음 만들어진 기본 사이트에서만 볼 수 있습니다. 사이트 데이터는 해당 데이터를 만든 기본 사이트에서만 수정할 수 있습니다. 이 유형에는 다음의 데이터가 포함됩니다.

- 하드웨어 인벤토리
- 상태 메시지
- 경고
- 쿼리 기반 컬렉션의 결과

모든 사이트 데이터는 CAS에 복제됩니다. CAS에서는 전체 사이트 계층의 관리 및 보고 작업을 수행합니다.  


## <a name="bkmk_Dblinks"></a> 데이터베이스 복제 링크

계층 구조에 새 사이트를 설치하면 Configuration Manager에서 부모 사이트와 새 사이트 간의 데이터베이스 복제 링크를 자동으로 만듭니다. 두 사이트를 연결하기 위한 단일 링크를 생성합니다.  

복제 링크를 통한 데이터 전송을 제어하려면 각 링크의 설정을 변경합니다. 각 복제 링크에서는 개별 구성을 지원합니다. 각 데이터베이스 복제 링크에는 다음의 제어가 포함됩니다.  

- 기본 사이트에서 CAS로의 선택된 사이트 데이터 복제를 중지합니다. 이렇게 하면 CAS에서는 기본 사이트의 데이터베이스에서 이 데이터로 곧바로 액세스합니다.  

- 선택된 사이트 데이터가 하위 기본 사이트에서 CAS로 전송되도록 예약합니다.

- 데이터베이스 복제 링크가 저하 또는 실패 상태가 되는 시점을 결정하는 설정을 정의합니다.

- 실패한 복제 링크에 대한 경고를 생성하는 시점을 지정합니다.

- 복제 링크를 사용하는 복제 트래픽과 관련된 데이터를 Configuration Manager에서 요약하는 빈도를 지정합니다. 보고서에서 이 데이터를 사용합니다.

데이터베이스 복제 링크를 구성하려면 Configuration Manager 콘솔에서 **모니터링** 작업 영역으로 이동합니다. **데이터베이스복제** 노드를 선택하고 링크의 속성을 편집합니다. 이 노드는 **계층 구성** 노드 아래의 **관리** 작업 영역에도 있습니다. 복제 링크는 해당 복제 링크의 부모 사이트 또는 자식 사이트에서 편집합니다.  

> [!TIP]  
> 데이터베이스 복제 링크는 두 작업 영역의 **데이터베이스 복제** 노드에서 편집할 수 있습니다. 하지만 **모니터링** 작업 영역의 **데이터베이스 복제** 노드를 사용하면 데이터베이스 복제 상태도 확인할 수 있습니다. 또한 [Replication Link Analyzer](/sccm/core/servers/manage/monitor-replication#BKMK_RLA) 도구에 액세스할 수도 있습니다. 이 도구를 사용하면 데이터베이스 복제 관련 문제를 더 원활히 조사할 수 있습니다.  

복제 링크 구성 방법에 대한 자세한 내용은 [사이트 데이터베이스 복제 제어](#BKMK_DBRepControls)를 참조하세요. 복제를 모니터링하는 방법에 대한 자세한 내용은 [데이터베이스 복제 모니터링](/sccm/core/servers/manage/monitor-replication)을 참조하세요.  


## <a name="bkmk_distviews"></a> 분산 보기  

선택된 사이트 데이터에 대해 CAS에서 요청할 때는 분산 보기를 통해 하위 기본 사이트의 데이터베이스에 곧바로 액세스합니다. 직접 액세스로 인해 해당 사이트 데이터를 기본 사이트에서 CAS로 복제할 필요가 없습니다. 각 복제 링크는 상호 독립적이므로 선택한 복제 링크에서 분산 보기를 사용할 수 있습니다. 기본 사이트와 보조 사이트 간에는 분산 보기를 사용할 수 없습니다.  

분산 보기는 다음과 같은 이점을 제공합니다.  

- CAS 및 기본 사이트에서 데이터베이스 변경을 처리할 때 발생하는 CPU 부하가 줄어듭니다.

- 네트워크를 통해 CAS에 전송되는 데이터의 양이 줄어듭니다.

- CAS 데이터베이스를 호스팅하는 SQL Server의 성능이 향상됩니다.

- CAS 데이터베이스에서 사용하는 디스크 공간이 줄어듭니다.

기본 사이트가 네트워크에서 CAS와 인접한 곳에 있으며 두 사이트가 상시적으로 작동하고 연결된 상태인 경우 분산 보기를 사용하는 것이 좋습니다. 이는 분산 보기를 사용하면 선택한 데이터를 각 사이트의 SQL Server 간 직접 연결을 통해 두 사이트 사이에서 복제하지 않아도 되기 때문입니다. 이 데이터를 요청할 때마다 CAS에서는 직접 연결을 만듭니다.

사이트에서는 다음의 예제 시나리오에서 분산 보기 데이터를 요청합니다.

- 보고서 또는 쿼리를 실행할 때
- 리소스 탐색기에서 정보를 볼 때
- 사이트 데이터 기반 규칙이 포함된 컬렉션의 컬렉션 평가

기본적으로 분산 보기는 각 복제 링크에 대해 꺼집니다. 분산 보기를 켜면 해당 링크를 통해 CAS로 복제되지 않는 사이트 데이터를 선택하게 됩니다. CAS는 해당 링크를 공유하는 하위 기본 사이트의 데이터베이스에서 이 데이터에 직접 액세스합니다. 분산 보기에 대해 다음과 같은 유형의 사이트 데이터를 구성할 수 있습니다.  

- 클라이언트의 **하드웨어 인벤토리** 데이터
- 클라이언트의 **소프트웨어 인벤토리 및 소프트웨어 계량** 데이터
- 클라이언트, 기본 사이트 및 모든 보조 사이트의 **상태 메시지**

Configuration Manager 콘솔이나 보고서에서 데이터를 볼 때는 분산 보기가 운영 특성상 보이지 않습니다. 분산 보기에 사용되는 데이터를 요청하면 CAS 사이트 데이터베이스 서버에서는 하위 기본 사이트의 데이터베이스에 곧바로 액세스하여 해당 정보를 검색합니다.

예를 들어, CA에 연결된 Configuration Manager 콘솔을 사용합니다. 두 기본 사이트 ABC 및 XYZ의 하드웨어 인벤토리에 대한 정보를 요청합니다. ABC 사이트의 분산 보기에 대해서만 하드웨어 인벤토리를 사용하도록 설정했습니다. CAS는 자체 데이터베이스에서 XYZ 클라이언트에 대한 인벤토리 정보를 검색합니다. CAS는 사이트 ABC의 데이터베이스에서 직접 ABC 클라이언트에 대한 인벤토리 정보를 검색합니다. 이 정보는 Configuration Manager 콘솔 또는 보고서에 원본의 구별 없이 나타납니다.  

복제 링크에 분산 보기에 대해 사용되는 데이터 형식이 있으면 하위 기본 사이트에서는 이 데이터를 CAS로 복제하지 않습니다. 데이터 형식에 대해 분산 보기를 끄면 하위 기본 사이트에서는 CAS로의 정상적인 데이터 복제를 다시 시작합니다. 이 데이터의 복제 그룹이 기본 사이트와 CAS 간에 다시 초기화된 후에야 CAS에서 이 데이터를 사용할 수 있습니다. 분산 보기가 켜져 있는 기본 사이트를 제거한 후에 CAS의 분산 보기에 대해 사용하도록 설정한 데이터에 액세스하려면 먼저 CAS에서 자체 데이터의 다시 초기화를 완료해야 합니다.  

> [!IMPORTANT]  
> 사이트 계층 구조 내 복제 링크에서 분산 보기를 사용할 경우 기본 사이트를 제거하기 전에 모든 복제 링크에 대한 분산 보기를 꺼야 합니다. 자세한 내용은 [분산 보기에 구성된 기본 사이트 제거](/sccm/core/servers/deploy/install/uninstall-sites-and-hierarchies#BKMK_UninstallPrimaryDistViews)을 참조하십시오.  

### <a name="prerequisites-and-limitations-for-distributed-views"></a>분산 보기의 필수 조건 및 제한 사항  

- 분산 보기는 CAS와 기본 사이트 간의 복제 링크에서만 사용합니다.

- CAS에서는 SQL Server Enterprise Edition을 사용해야 합니다. 기본 사이트에는 이러한 요구 사항이 없습니다.

- CAS에는 SMS 공급자의 인스턴스가 하나만 있습니다. 해당 단일 인스턴스를 사이트 데이터베이스 서버에 설치합니다. 이 구성은 Kerberos 인증을 지원합니다. CAS의 SQL Server는 하위 기본 사이트의 SQL Server에 액세스하는 데 Kerberos가 필요합니다. 자식 기본 사이트의 SMS 공급자에 대한 제한 사항은 없습니다.

- CAS에 보고 서비스 지점을 하나만 설치할 수 있습니다. 사이트 데이터베이스 서버에 SQL Server Reporting Services를 설치합니다. 이 구성은 Kerberos 인증을 지원합니다. CAS의 SQL Server는 하위 기본 사이트의 SQL Server에 액세스하는 데 Kerberos가 필요합니다.

- 사이트 데이터베이스를 [SQL Server 클러스터](/sccm/core/servers/deploy/configure/use-a-sql-server-cluster-for-the-site-database)에 호스팅할 수 없습니다.

- 버전 1902 이하에서는 [SQL Server Always On 가용성 그룹](/sccm/core/servers/deploy/configure/sql-server-alwayson-for-a-highly-available-site-database)에 사이트 데이터베이스를 호스팅할 수 없습니다. 이 구성을 지원하려면 버전 1906 이상으로 업데이트해야 합니다.<!-- SCCMDocs-pr#3792 -->

- CAS 데이터베이스 서버의 컴퓨터 계정에는 기본 사이트 데이터베이스에 대한 **읽기** 권한이 필요합니다.

> [!IMPORTANT]  
> 분산 보기 및 데이터 복제 시점의 [일정](#BKMK_schedules)은 데이터베이스 복제 링크에 대해 상호 배타적인 설정입니다.  


## <a name="BKMK_schedules"></a> 사이트 데이터의 전송 예약

하위 기본 사이트에서 CAS로의 사이트 데이터 복제에 사용되는 네트워크 대역폭을 제어하기 쉽도록 복제 링크의 사용 시점을 예약합니다. 그런 후 여러 다른 형식의 사이트 데이터가 복제되는 시점을 지정합니다. 기본 사이트에서 상태 메시지, 인벤토리 및 계량 데이터를 복제하는 시점을 제어할 수 있습니다. 보조 사이트의 데이터베이스 복제 링크는 사이트 데이터에 대한 일정을 지원하지 않습니다. 글로벌 데이터의 전송은 예약할 수 없습니다.  

데이터베이스 복제 링크 일정을 구성할 때는 선택된 사이트 데이터를 기본 사이트에서 CAS로 전송하는 데 제한을 둘 수 있습니다. 또한 여러 형식의 사이트 데이터를 복제하도록 서로 다른 시간을 구성할 수도 있습니다.  

> [!IMPORTANT]  
> [분산 보기](#bkmk_distviews) 및 데이터 복제 시점의 일정은 데이터베이스 복제 링크에 대해 상호 배타적인 구성입니다.  


## <a name="BKMK_SummarizeDBReplication"></a> 트래픽 요약  

각 사이트에서는 해당 사이트에 대한 데이터베이스 복제 링크를 트래버스하는 네트워크 트래픽의 관련 데이터를 정기적으로 요약합니다. 이 사이트에서는 데이터베이스 복제용 보고서에 요약된 데이터를 사용합니다. 복제 링크의 두 사이트는 모두 복제 링크에서 이동하는 네트워크 트래픽을 요약합니다. 사이트 데이터베이스 서버는 데이터를 요약합니다. 데이터가 요약된 후 이 정보는 다른 사이트에 글로벌 데이터로서 복제됩니다.  

기본적으로 요약은 15 분마다 발생합니다. 네트워크 트래픽에 대한 요약 빈도를 수정하려면 데이터베이스 복제 링크의 속성에서 **요약 간격**을 편집합니다. 요약 빈도는 데이터베이스 복제 관련 보고서에 표시되는 정보에 영향을 줍니다. 간격은 5~60분 사이에서 선택할 수 있습니다. 요약 빈도를 늘리면 복제 링크의 각 사이트에 있는 SQL Server에서 처리 부하도 늘어납니다.  

## <a name="BKMK_DBRepThresholds"></a> 데이터베이스 복제 임계값

데이터베이스 복제 임계값은 Configuration Manager가 데이터베이스 복제 링크의 상태를 저하 또는 실패로 보고하는 시점을 정의합니다. 기본적으로 사이트에서는 임의의 한 복제 그룹에서 복제를 12회 연속으로 시도했으나 실패한 경우 링크를 *저하됨*으로 설정합니다. 복제 그룹에서 복제를 24회 연속으로 시도했으나 실패한 경우에는 링크를 *실패*로 설정합니다.  

저하나 실패 상태는 사용자 지정 값을 정할 수 있습니다. 이 값을 조정하면 링크를 통한 데이터베이스 복제의 상태를 더욱 정확히 모니터링할 수 있습니다.  

하나 이상의 복제 그룹이 복제에 실패하지만 다른 복제 그룹은 복제에 계속 성공할 수도 있습니다. 링크의 복제 상태는 저하됨이 처음 보고될 때 검토를 계획합니다.

다음과 같은 상황에서 링크의 저하됨 또는 실패 상태의 재시도 값을 수정하는 것이 좋습니다.

- 특정 복제 그룹에 대해 지연이 반복되며 지연 시간은 문제가 되지 않습니다.

- 사이트 간 네트워크 링크의 가용 대역폭이 부족합니다.

링크가 저하됨 또는 실패로 설정되기 전의 재시도 횟수를 늘리면 알려진 이슈에 대해 거짓 경고를 방지할 수 있습니다. 이 작업을 통해 링크 상태를 보다 정확하게 추적할 수 있습니다.  

또한 해당 그룹의 복제가 발생하는 빈도를 파악하기 위해 각 복제 그룹에 대한 복제 동기화 간격을 고려합니다. 복제 그룹에 대한 **동기화 간격**을 보려면 Configuration Manager 콘솔의 **모니터링** 작업 영역으로 이동합니다. **데이터베이스 복제** 노드에서 복제 링크의 **복제 세부 정보** 탭을 선택합니다.  

복제 상태를 확인하는 방법을 포함하여 데이터베이스 복제를 모니터링하는 방법에 대한 자세한 내용은 [ 데이터베이스 복제 모니터링](/sccm/core/servers/manage/monitor-replication)을 참조하세요.  


## <a name="BKMK_DBRepControls"></a> 사이트 데이터베이스 복제 제어  

데이터베이스 복제에 사용되는 네트워크 대역폭을 제어하기 쉽도록 각 사이트 데이터베이스의 설정을 변경합니다. 설정은 해당 설정을 구성한 사이트 데이터베이스에만 적용되며, 사이트에서 데이터베이스 복제를 통해 다른 사이트에 데이터를 복제할 때 항상 사용됩니다.  

각 사이트 데이터베이스에 대해 다음의 복제 제어를 수정할 수 있습니다.  

- SSB 포트  

- 복제 실패가 사이트에서 자체 사이트 데이터베이스 복사본을 다시 초기화하도록 트리거하기 전까지의 대기 시간  

- 사이트에서 복제하는 데이터를 압축합니다. 사이트 간 전송을 위해서만 데이터를 압축하며, 어느 사이트든 사이트 데이터베이스에 스토리지할 목적으로는 압축하지 않습니다.  

사이트 데이터베이스에 대한 복제 제어 설정을 변경하려면 Configuration Manager 콘솔의 **데이터베이스 복제** 노드에서 사이트 데이터베이스의 속성을 편집합니다. 이 노드는 **관리** 작업 영역의 **계층 구성** 노드 아래에 나타나며 **모니터링 작업 영역**에도 나타납니다. 사이트 데이터베이스의 속성을 편집하려면 사이트 간 복제 링크를 선택한 다음 **부모 데이터베이스 속성** 또는 **자식 데이터베이스 속성**을 엽니다.  

> [!TIP]  
> 데이터베이스 복제 제어는 두 작업 영역의 **데이터베이스 복제** 노드에서 구성할 수 있습니다. 그러나 **모니터링** 작업 영역의 **데이터베이스 복제** 노드를 사용하면 그 밖에 복제 링크에 대한 데이터베이스 복제 상태를 볼 수 있고 Replication Link Analyzer 도구를 사용하여 복제 관련 문제를 검사할 수 있습니다.  


## <a name="see-also"></a>참고 항목

[복제 모니터링](/sccm/core/servers/manage/monitor-replication)

[SQL 복제 모니터링](/sccm/core/servers/manage/replication/overview)
