---
title: 클라이언트 피어 캐시
titleSuffix: Configuration Manager
description: Configuration Manager를 사용하여 콘텐츠를 배포할 때 원본 위치에 클라이언트 피어 캐시를 사용합니다.
ms.date: 09/19/2018
ms.prod: configuration-manager
ms.technology: configmgr-other
ms.topic: conceptual
ms.assetid: 86cd5382-8b41-45db-a4f0-16265ae22657
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.collection: M365-identity-device-management
ms.openlocfilehash: 4754077f1a91cd11ce16e17dd3d2ea2f1704ee08
ms.sourcegitcommit: 79c51028f90b6966d6669588f25e8233cf06eb61
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/19/2019
ms.locfileid: "68338885"
---
# <a name="peer-cache-for-configuration-manager-clients"></a>Configuration Manager 클라이언트용 피어 캐시

*적용 대상: System Center Configuration Manager(현재 분기)*

<!--1101436-->
피어 캐시를 사용하면 원격 위치의 클라이언트로의 콘텐츠 배포를 관리하는 데 도움이 됩니다. 피어 캐시는 클라이언트가 로컬 캐시의 콘텐츠를 다른 클라이언트와 직접 공유할 수 있도록 하는 기본 제공 Configuration Manager 솔루션입니다.   

> [!Note]  
> Configuration Manager는 기본적으로 이 선택적 기능을 활성화하지 않습니다. 이 기능은 사용하기 전에 활성화해야 합니다. 자세한 내용은 [업데이트에서 선택적 기능 사용](/sccm/core/servers/manage/install-in-console-updates#bkmk_options)을 참조하세요.<!--505213-->  



## <a name="overview"></a>개요

정의:  

- **피어 캐시 클라이언트**: 피어에서 콘텐츠를 다운로드하는 모든 Configuration Manager 클라이언트  

- **피어 캐시 원본**: 사용자가 피어 캐시에 대해 활성화하고, 다른 클라이언트와 공유할 콘텐츠가 있는 Configuration Manager 클라이언트  

클라이언트 설정을 사용하여 클라이언트가 피어 캐시 원본을 사용하도록 설정합니다. 피어 캐시 클라이언트를 활성화할 필요가 없습니다. 클라이언트를 피어 캐시 원본으로 활성화하면 관리 지점이 이를 콘텐츠 위치 원본 목록에 포함합니다.<!--510397--> 이 프로세스에 대한 자세한 내용은 [작업](#operations)을 참조하세요.  

피어 캐시 원본은 피어 캐시 클라이언트의 현재 경계 그룹의 멤버여야 합니다. 관리 지점은 인접 경계 그룹의 피어 캐시 원본을 클라이언트에 제공하는 콘텐츠 원본 목록에 포함되지 않습니다. 인접 경계 그룹의 배포 지점만 포함합니다. 현재 및 인접 경계 그룹에 대한 자세한 내용은 [경계 그룹](/sccm/core/servers/deploy/configure/boundary-groups)을 참조하세요.<!--SCCMDocs issue 685-->  

Configuration Manager 클라이언트는 피어 캐시를 사용하여 캐시의 모든 유형의 콘텐츠를 다른 클라이언트에 제공합니다. 이 콘텐츠에는 Office 365 파일과 빠른 설치 파일이 포함됩니다.<!--SMS.500850-->  

피어 캐시는 Windows BranchCache 또는 배달 최적화와 같은 다른 솔루션의 사용을 대체하지 않습니다. 피어 캐시는 다른 솔루션과 함께 작동합니다. 이러한 기술은 배포 지점과 같은 기존의 콘텐츠 배포 솔루션을 확장할 수 있는 추가 옵션을 제공합니다. 피어 캐시는 BranchCache를 사용하지 않는 사용자 지정 솔루션입니다. BranchCache를 사용하도록 설정하거나 사용하지 않는 경우에도 피어 캐시는 계속 작동합니다.  

> [!Note]  
> 버전 1802부터 Windows BranchCache는 항상 배포에서 사용할 수 있습니다. **클라이언트가 동일한 서브넷에 있는 다른 클라이언트와 콘텐츠를 공유하도록 허용**하는 설정이 제거됩니다.<!--SCCMDocs issue 539--> 배포 지점에서 지원하고 클라이언트 설정에서 사용하도록 설정된 경우 클라이언트에서는 BranchCache를 사용합니다. 자세한 내용은 [BranchCache 구성](/sccm/core/clients/deploy/about-client-settings#configure-branchcache)을 참조하세요.<!--SCCMDocs issue 735-->   



## <a name="operations"></a>작업

피어 캐시를 사용하도록 설정하려면 [클라이언트 설정](#bkmk_settings)을 컬렉션에 배포합니다. 그런 다음, 컬렉션의 멤버는 동일한 경계 그룹에 있는 다른 클라이언트에 대한 피어 캐시 원본 역할을 합니다.  

- 피어 콘텐츠 원본으로 작동하는 클라이언트는 사용할 수 있는 캐시된 콘텐츠 목록을 해당 관리 지점에 제출합니다.  

- 동일한 경계 그룹의 다른 클라이언트는 관리 지점에 콘텐츠 위치 요청을 수행합니다. 서버는 잠재적 콘텐츠 원본의 목록을 반환합니다. 이 목록에는 콘텐츠가 있고 온라인 상태인 각 피어 캐시 원본이 포함됩니다. 또한 해당 경계 그룹의 배포 지점 및 다른 콘텐츠 원본 위치도 포함됩니다. 자세한 내용은 [콘텐츠 원본 우선 순위](/sccm/core/plan-design/hierarchy/fundamental-concepts-for-content-management#content-source-priority)를 참조하세요.  

- 일반적으로 콘텐츠를 검색하는 클라이언트는 제공된 목록에서 원본 하나를 선택합니다. 그런 다음 클라이언트에서 해당 콘텐츠를 가져오려고 시도합니다.  

1806 버전부터 경계 그룹에는 사용자 환경에서 콘텐츠 배포를 보다 세밀하게 제어할 수 있는 추가 설정이 포함됩니다. 자세한 내용은 [피어 다운로드를 위한 경계 그룹 옵션](/sccm/core/servers/deploy/configure/boundary-groups#bkmk_bgoptions)을 참조하세요.<!--1356193-->

> [!NOTE]  
> 클라이언트가 콘텐츠의 인접 경계 그룹으로 대체될 경우, 관리 지점은 인접 경계 그룹의 피어 캐시 원본을 잠재적 콘텐츠 원본 위치 목록에 추가하지 않습니다.  

피어 캐시 원본으로 가장 적합한 클라이언트만 선택합니다. 섀시 종류, 디스크 공간 및 네트워크 연결과 같은 특성에 따라 클라이언트 적합성을 평가합니다. 피어 캐시에 사용하기에 가장 적합한 클라이언트를 선택하는 데 도움이 되는 자세한 내용은 [Microsoft 컨설턴트의 블로그](https://blogs.technet.microsoft.com/askpfeplat/2018/11/21/configuration-manager-peer-cache-custom-reporting-examples/)를 참조하세요.


### <a name="limited-access-to-a-peer-cache-source"></a>피어 캐시 원본에 대한 제한된 액세스  

피어 캐시 원본은 피어가 콘텐츠를 요청할 때 다음 조건 중 하나라도 충족할 경우 콘텐츠 요청을 거부합니다.  

- 배터리 부족 모드  

- 프로세서 로드가 80%를 초과하는 경우  

- 디스크 I/O에 10을 초과하는 *AvgDiskQueueLength*가 있는 경우  

- 컴퓨터에 대한 연결을 더 이상 사용할 수 없는 경우  

> [!Tip]  
> Configuration Manager SDK에서 피어 원본 기능에 대한 클라이언트 구성 서버 WMI 클래스(*SMS_WinPEPeerCacheConfig*)를 사용하여 이러한 설정을 구성합니다.  

피어 캐시 원본에서 콘텐츠 요청을 거부하는 경우 피어 캐시 클라이언트는 콘텐츠 원본 위치 목록에서 콘텐츠를 계속 검색합니다.   



## <a name="requirements"></a>요구 사항

- 피어 캐시는 [클라이언트 및 디바이스에 지원되는 운영 체제](/sccm/core/plan-design/configs/supported-operating-systems-for-clients-and-devices)에서 지원되는 것으로 표시된 모든 Windows 버전을 지원합니다. Windows 이외의 운영 체제는 피어 캐시 원본 또는 피어 캐시 클라이언트로 지원되지 않습니다.  

- 피어 캐시 원본은 도메인에 가입된 Configuration Manager 클라이언트여야 합니다. 그러나 도메인에 가입되지 않은 클라이언트는 도메인에 가입된 피어 캐시 원본에서 콘텐츠를 가져올 수 있습니다.  

- 클라이언트는 현재 경계 그룹의 피어 캐시 원본에서만 콘텐츠를 다운로드할 수 있습니다.  

- [네트워크 액세스 계정](/sccm/core/plan-design/hierarchy/accounts#network-access-account)은 다음과 같은 경우에만 필요합니다.  

  - 피어 캐시 사용 클라이언트가 소프트웨어 센터에서 작업 순서를 실행하고 부팅 이미지로 다시 부팅될 때 사이트에서 네트워크 액세스 계정을 구성합니다. 디바이스가 Windows PE에 있으면 네트워크 액세스 계정을 사용하여 피어 캐시 원본에서 콘텐츠를 가져옵니다.  

  - 필요한 경우 피어 캐시 원본에서 네트워크 액세스 계정을 사용하여 피어의 다운로드 요청을 인증합니다. 이 계정에는 이 용도의 도메인 사용자 권한만 필요합니다.  

- 1802 이하 버전에서는 클라이언트의 마지막 하트비트 검색 제출에 따라 피어 캐시 원본의 현재 경계가 결정됩니다. 다른 경계 그룹으로 로밍하는 클라이언트는 여전히 피어 캐시를 위해 이전 경계 그룹의 멤버일 수 있습니다. 이 동작으로 인해 직접 네트워크 위치에 있지 않은 피어 캐시 원본이 클라이언트에 제공됩니다. 로밍 클라이언트를 피어 캐시 원본으로 사용하지 마세요.<!--SCCMDocs issue 641-->  

  > [!Important]  
  > 1806 버전부터는 피어 캐시 원본이 다른 위치로 로밍되었는지 확인하는 Configuration Manager의 효율이 향상되었습니다. 이 동작을 통해 관리 지점은 피어 캐시 원본을 이전 위치가 아닌 새 위치의 클라이언트에 콘텐츠 원본으로 제공합니다. 로밍 피어 캐시 원본에 피어 캐시 기능을 사용하는 경우 사이트를 1806 버전으로 업데이트 한 후 모든 피어 캐시 원본을 최신 클라이언트 버전으로 업데이트해야 합니다. 피어 캐시 원본이 버전 1806 이상으로 업데이트되기 전에는, 관리 지점이 이러한 피어 캐시 원본을 콘텐츠 위치 목록에 포함하지 않습니다.<!--SCCMDocs issue 850-->  

- 콘텐츠를 다운로드하기 전에 관리 지점은 먼저 피어 캐시 원본이 온라인 상태인지 확인합니다.<!--sms.498675--> 이 유효성 검사는 TCP 포트 10123을 사용하는 클라이언트 알림의 “빠른 채널”을 통해 수행됩니다.<!--511673-->  

> [!Note]  
> 새 Configuration Manager 기능을 활용하려면 먼저 클라이언트를 최신 버전으로 업데이트합니다. 사이트 및 콘솔을 업데이트할 때 Configuration Manager 콘솔에 새 기능이 표시되지만 클라이언트 버전도 최신 버전이 될 때까지 전체 시나리오가 작동하지 않습니다.  



## <a name="bkmk_settings"></a> 피어 캐시 클라이언트 설정

피어 캐시 클라이언트 설정에 대한 자세한 내용은 [클라이언트 캐시 설정](/sccm/core/clients/deploy/about-client-settings#client-cache-settings)을 참조하세요. 

이러한 설정을 구성하는 방법에 대한 자세한 내용은 [클라이언트 설정을 구성하는 방법](/sccm/core/clients/deploy/configure-client-settings)을 참조하세요.

Windows 방화벽을 사용하는 피어 캐시 사용 클라이언트에서 Configuration Manager는 클라이언트 설정에서 지정된 방화벽 포트를 구성합니다.



## <a name="bkmk_parts"></a> 부분 다운로드 지원
<!--1357346-->
버전 1806부터 이제 클라이언트 피어 캐시 원본은 콘텐츠를 여러 부분으로 나눌 수 있습니다. 이러한 부분은 네트워크 전송을 최소화하여 WAN 사용률을 줄입니다. 관리 지점은 콘텐츠 부분의 더 자세한 추적을 제공합니다. 경계 그룹별로 동일한 콘텐츠의 2회 이상 다운로드를 제거하려고 시도합니다. 


### <a name="example-scenario"></a>예제 시나리오

Contoso는 다음과 같은 두 경계 그룹이 있는 단일 주 사이트를 운영합니다. HQ(본사) 및 지점. 경계 그룹 간에는 30분의 대체(fallback) 관계가 있습니다. 사이트의 관리 지점 및 배포 지점은 HQ 경계에만 있습니다. 지사 위치에는 로컬 배포 지점이 없습니다. 지사의 네 클라이언트 중 두 개는 피어 캐시 원본으로 구성됩니다. 

![예제 시나리오에 설명된 네트워크 구성의 다이어그램](media/1357346-peer-cache-source-parts.png)

1. 지사의 네 가지 클라이언트 모두에 대한 콘텐츠가 포함된 배포를 대상으로 합니다. 배포 지점에만 콘텐츠를 배포합니다.  

2. Client3 및 Client4에는 배포를 위한 로컬 원본이 없습니다. 관리 지점은 클라이언트가 원격 경계 그룹에 대체되기 전에 30분을 대기하도록 지시합니다.  

3. Client1(PCS1)은 관리 지점으로 정책을 새로 고치는 첫 번째 피어 캐시 원본입니다. 이 클라이언트는 피어 캐시 원본으로 사용 가능하므로 관리 지점은 이 클라이언트에게 배포 지점에서 A 부분을 즉시 다운로드하도록 지시합니다.  

4. Client2(PCS2)가 관리 지점에 연결되면 A 부분이 이미 진행 중이지만 아직 완료되지 않았으므로 관리 지점은 이 클라이언트에게 배포 지점에서 B 부분을 즉시 다운로드하도록 지시합니다.  

5. PCS1은 A 부분의 다운로드가 완료되면 즉시 관리 지점에 알립니다. B 부분이 이미 진행 중이지만 아직 완료되지 않은 경우 관리 지점은 이 클라이언트에게 배포 지점에서 C 부분을 즉시 다운로드하도록 지시합니다.  

6. PCS2는 B 부분의 다운로드가 완료되면 즉시 관리 지점에 알립니다. 관리 지점은 이 클라이언트에게 배포 지점에서 D 부분을 다운로드하도록 지시합니다.  

7. PCS1은 C 부분의 다운로드가 완료되면 즉시 관리 지점에 알립니다. 관리 지점은 이 클라이언트에게 원격 배포 지점에서 사용할 수 있는 부분이 더 이상 없음을 알립니다. 관리 지점은 이 클라이언트에게 해당 로컬 피어 PCS2에서 B 부분을 다운로드하도록 지시합니다.  

8. 이 프로세스는 두 클라이언트 피어 캐시 원본이 서로의 모든 부분을 다운로드할 때까지 계속됩니다. 관리 지점은 피어 캐시 원본에게 로컬 피어에서 부분을 다운로드하도록 지시하기 전에 원격 배포 지점에서 부분의 우선 순위를 지정합니다.  

9. Client3은 30분 대체 기간이 만료된 후 처음으로 정책을 새로 고칩니다. 이제 관리 지점에 다시 확인하면 관리 지점에서 클라이언트에게 새 로컬 원본을 알려줍니다. WAN을 통해 배포 지점에서 콘텐츠를 전체적으로 다운로드하는 대신 클라이언트 피어 캐시 원본 중 하나에서 콘텐츠를 전체적으로 다운로드합니다. 클라이언트는 로컬 피어 원본의 우선 순위를 지정합니다. 

> [!Note]  
> 클라이언트 피어 캐시 원본 수가 콘텐츠 부분 수보다 큰 경우 관리 지점은 일반 클라이언트처럼 추가 캐시 원본에 대체 대기를 지시합니다. 


### <a name="configure-partial-download"></a>부분 다운로드 구성

1. 평소와 같이 [경계 그룹](/sccm/core/servers/deploy/configure/boundary-groups) 및 피어 캐시 원본을 설정합니다.  

2. Configuration Manager 콘솔에서 **관리** 작업 영역으로 이동하여 **사이트 구성**을 확장하고 **사이트**를 선택합니다. 리본에서 **계층 구조 설정**을 클릭합니다.  

3. **일반** 탭에서 **콘텐츠를 여러 부분으로 분할하도록 클라이언트 피어 캐시 원본을 구성**하는 옵션을 활성화합니다.  

4. 콘텐츠로 필수 배포를 만듭니다.  

   > [!Note]  
   > 이 기능은 클라이언트가 필수 배포 등을 사용하여 백그라운드로 콘텐츠를 다운로드할 때만 작동합니다. 사용자가 소프트웨어 센터에서 사용 가능한 배포를 설치하는 경우와 같은 요청 시 다운로드는 평소와 같이 작동합니다.  

콘텐츠를 여러 부분으로 나누어 다운로드를 처리하는 것을 보려면 피어 캐시 원본의 **ContentTransferManager.log**와 관리 지점의 **MP_Location.log**를 확인합니다.  



## <a name="guidance-for-cache-management"></a>캐시 관리 지침
<!--510645-->
피어 캐시는 구성 관리자 클라이언트 캐시를 사용하여 콘텐츠를 공유합니다. 사용자 환경에서 클라이언트 캐시를 관리하는 방법에 대한 다음 사항을 고려하세요.  

- Configuration Manager 클라이언트 캐시는 배포 지점의 콘텐츠 라이브러리와 다릅니다. 사용자가 배포 지점에 배포하는 콘텐츠를 관리하는 동안 Configuration Manager 클라이언트는 해당 캐시의 콘텐츠를 자동으로 관리합니다. 피어 캐시 원본의 캐시에 있는 콘텐츠를 제어하는 데 도움이 되는 설정 및 메서드가 있습니다. 자세한 내용은 [Configuration Manager 클라이언트에 대한 클라이언트 캐시 구성](/sccm/core/clients/manage/manage-clients#BKMK_ClientCache)을 참조하세요.  

- 피어 캐시 원본에는 기본 캐시 크기 및 유지 관리가 적용됩니다. 자세한 내용은 [클라이언트 캐시 크기 구성](/sccm/core/clients/deploy/about-client-settings#configure-client-cache-size)을 참조하세요. OS 업그레이드 패키지 또는 Windows 10 빠른 업데이트 파일과 같은 더 큰 콘텐츠의 크기를 고려합니다. 이 콘텐츠의 필요성을 피어 캐시 원본의 사용 가능한 디스크 공간과 비교합니다.  

- 피어 캐시 원본 클라이언트는 피어가 캐시를 다운로드할 때 캐시에 있는 콘텐츠의 마지막 참조 시간을 업데이트합니다. 클라이언트는 캐시를 자동으로 유지 관리하면서 오래된 콘텐츠를 먼저 제거할 때 이 타임스탬프를 사용합니다. 따라서 피어 캐시 클라이언트가 더 자주 다운로드하는 콘텐츠를 제거할 때까지 대기해야 합니다.  

- 필요한 경우, OS 배포 작업 순서 중에 **SMSTSPreserveContent** 변수를 사용하여 콘텐츠를 클라이언트 캐시에 보관합니다. 자세한 내용은 [Task sequence variables](/sccm/osd/understand/task-sequence-variables#SMSTSPreserveContent)\(작업 순서 변수\)를 참조하세요.  

- 필요한 경우, 다음 소프트웨어를 만들 때 **클라이언트 캐시의 콘텐츠 유지** 옵션을 사용합니다.  
  - 애플리케이션
  - 패키지
  - OS 이미지
  - OS 업그레이드 패키지
  - 부팅 이미지



## <a name="monitoring"></a>모니터링   

**클라이언트 데이터 원본** 대시보드를 확인하면 피어 캐시 사용법을 쉽게 파악할 수 있습니다. 자세한 내용은 [클라이언트 데이터 원본 대시보드](/sccm/core/servers/deploy/configure/monitor-content-you-have-distributed#client-data-sources-dashboard)를 참조하세요.

또한 보고서를 사용하여 피어 캐시 사용을 확인합니다. 콘솔에서 **모니터링** 작업 영역으로 이동하여 **보고**를 확장하고 **보고서** 노드를 선택합니다. 다음 보고서는 모두 **소프트웨어 배포 콘텐츠** 유형입니다.  

1.  **피어 캐시 원본 콘텐츠 거부**: 경계 그룹의 피어 캐시 원본에서 콘텐츠 요청을 거부하는 빈도.  

    > [!Note]  
    > **알려진 문제**<!--486652-->: *MaxCPULoad* 또는 *MaxDiskIO*와 같은 결과를 드릴다운하면 보고서나 세부 정보를 찾을 수 없음을 나타내는 오류가 표시될 수 있습니다. 이 문제를 해결하려면 결과를 직접 표시하는 다른 두 가지 보고서를 사용합니다.  

2. **조건별 피어 캐시 원본 콘텐츠 거부**: 지정된 경계 그룹 또는 거부 유형에 대한 거부 세부 정보를 표시합니다. 

    > [!Note]  
    > **알려진 문제**<!--486652-->: 사용 가능한 매개 변수에서 선택할 수 없으면 매개 변수를 수동으로 입력해야 합니다. **피어 캐시 원본 콘텐츠 거부** 보고서에 표시된 대로 *경계 그룹 이름* 및 *거부 유형*의 값을 입력합니다. 예를 들어 *거부 유형*의 경우 *MaxCPULoad* 또는 *MaxDiskIO*를 입력할 수 있습니다.  

3. **피어 캐시 원본 콘텐츠 거부 세부 정보**: 거부되었을 경우 클라이언트에서 요청한 콘텐츠를 표시합니다.  

    > [!Note]  
    > **알려진 문제**<!--486652-->: 사용 가능한 매개 변수에서 선택할 수 없으면 매개 변수를 수동으로 입력해야 합니다. **피어 캐시 원본 콘텐츠 거부** 보고서에 표시된 대로 *거부 유형*의 값을 입력합니다. 그런 다음 추가 정보가 필요한 콘텐츠 원본에 대한 *리소스 ID*를 입력합니다. 
    > 
    > 콘텐츠 원본의 리소스 ID를 찾으려면:  
    > 
    > 1. **조건별 피어 캐시 원본 콘텐츠 거부** 보고서의 결과에 *피어 캐시 원본*으로 표시되는 컴퓨터 이름을 찾습니다.  
    > 
    > 2. **자산 및 준수** 작업 영역으로 이동하여 **디바이스** 노드를 선택하고 해당 컴퓨터의 이름을 검색합니다. 리소스 ID 열의 값을 사용합니다.  

